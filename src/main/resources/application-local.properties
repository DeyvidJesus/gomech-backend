spring.config.activate.on-profile=local

# Banco hospedado na VPS
spring.datasource.url=jdbc:postgresql://186.202.57.87:5432/gomech
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.username=gomech_user
spring.datasource.password=@Ernesto12
ai.service.url=http://localhost:5000

# Pool Hikari dimensionado para VPS de 1GB RAM
spring.datasource.hikari.pool-name=gomech-pool
spring.datasource.hikari.maximum-pool-size=4
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=15000
spring.datasource.hikari.idle-timeout=180000
spring.datasource.hikari.max-lifetime=900000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.leak-detection-threshold=45000
spring.datasource.hikari.initialization-fail-timeout=0
spring.datasource.hikari.keepalive-time=600000

spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# Ajustes Tomcat
server.tomcat.max-threads=50
server.tomcat.accept-count=50
server.tomcat.connection-timeout=5000
server.tomcat.max-connections=100
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=15s

# Reducao de logs e overhead
spring.main.banner-mode=off
spring.main.log-startup-info=false
logging.level.root=WARN
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# Actuator/health endpoints leves
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=never
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true
management.metrics.enable.process=false

spring.flyway.enabled=false
spring.datasource.hikari.auto-commit=false
spring.datasource.hikari.register-mbeans=true
